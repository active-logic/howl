⊐ System.IO;
⊐ InvOp = System.InvalidOperationException;
⊐ NUnit.Framework;
⊐ Active.Howl;

⊓ Unit{
‒ ○ TreeSitterTest : TestBase{

    Map map = ⌢ Rep[]{
        Classifier.o * ("+", "plus"),
        Classifier.o * ("-", "minus")
    };

    ؟ Inject(){
        ∙ g = "These (__Op__) are operators";
        ∙ @out = TreeSitter.Inject(g, map, raise: ✗);
        o( @out, "These ('+', '-') are operators");
    }

    ؟ Inject_Finely(){
        ∙ g = "__%plus%__ and __%minus%__ are operators";
        ∙ @out = TreeSitter.Inject(g, map, raise: ✗);
        o( @out, "'+' and '-' are operators");
    }

    ؟ InjectEach(){
        ∙ g = "__%plus%__ and __%minus%__ are operators";
        ∙ @out = TreeSitter.InjectEach(
            g, Classifier.o, map, raise: ✓);
        o( @out, "'+' and '-' are operators");
    }

    ؟ Inject_Failed(){
        ∙ g = "These (__Bo__) are operators";
        ㄹ @out;
        ಠᴗಠ<InvOp>(
            () → @out = TreeSitter.Inject(g, map)
        );
    }

    ؟ Format(){
        ∙ @out = TreeSitter.Format(Classifier.o, map);
        o( @out, "'+', '-'");
    }

    ؟ Tag_ForClass()
    → o( TreeSitter.Tag(Classifier.o), "__Op__" );

    ؟ Tag_ForRule()
    → o( TreeSitter.Tag(⌢ Rep("o", "bool")), "__%bool%__" );

}}
