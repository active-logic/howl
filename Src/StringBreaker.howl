âŠ System.Collections.Generic;
âŠ System.Text;

âŠ“ Active.Howl{
â€’Ì¥ â—‹ StringBreaker{

    â€’Ì¥ ã…‡ DenotesBlock(â¦¿ ã„¹ x, params Block.Def[] defs){
        âˆ€(âˆ™ k âˆˆ defs)
            â¤´(x.StartsWith(k.prefix)) â® âœ“;
        â® âœ—;
    }

    â€’Ì¥ ã„¹[] Break(â¦¿ ã„¹ x, params Block.Def[] defs){
        âˆ™ ã„¸ = âŒ¢ ğ•ƒ<ã„¹>();
        âˆ™ buffer = âŒ¢ StringBuilder();
        Block block = âˆ…;
        âŸ³(á† i = 0; i < xâ™; i++){
            â¤´(Enter(x, i, defs, ref block)){
                Flush(buffer, ã„¸);
                buffer.Â±(x[i]);
            }â¤³(block?.Exit(x, i) ?? âœ—){
                buffer.Â±(x[i]);
                Flush(buffer, ã„¸);
                block = âˆ…;
            }
            â¤µ buffer.Â±(x[i]);
        }
        Flush(buffer, ã„¸);
        â® ã„¸à§´;
    }

    â€’Ì¥ ã…‡ Enter(ã„¹ x, á† i, Block.Def[] dfs, ref Block bk){
        â¤´(bk â‰  âˆ…) â® âœ—;
        âˆ€(âˆ™ k âˆˆ dfs){
            âˆ™ z = Block.Enter(x, i, k);
            â¤´(z â‰  âˆ…){
                bk = z; â® âœ“;
            }
        }
        â® âœ—;
    }

    â€’Ì¥ â”ˆ Flush(StringBuilder buf, ğ•ƒ<ã„¹> ã„¸){
        â¤´(bufâ™ â˜° 0) â®;
        ã„¸.Add(bufğŸ );
        buf.Clear();
    }

}}
